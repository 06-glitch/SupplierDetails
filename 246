```powerscript
// 1. Production adding output SKU to Manufacturing Order
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_output.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_output.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Error", "Cannot add output SKU with GGSM SEG COND 'D' and invalid Accounting Control Code (3, 5 or NULL).")
    RETURN
END IF
```

```powerscript
// 2. Analyst adding output to a BOM
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_bom_output.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_bom_output.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Error", "Cannot add BOM output with GGSM SEG COND 'D' and invalid Accounting Control Code (3, 5 or NULL).")
    RETURN
END IF
```

```powerscript
// 3. Creating a manufacturing order with SEG COND 'D'
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_order.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_order.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Error", "Invalid SKU in new manufacturing order. GGSM SEG COND 'D' is not allowed with Accounting Control Code 3, 5, or NULL.")
    RETURN
END IF
```

```powerscript
// 4. Changing manufacturing order from Firmed to Scheduled
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_order_status.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_order_status.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Status Change Blocked", "Cannot move to 'Scheduled'. GGSM SEG COND 'D' with Accounting Control Code 3, 5, or NULL is invalid.")
    RETURN
END IF
```

```powerscript
// 5. Changing manufacturing order from Scheduled to Active
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_order_status.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_order_status.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Status Change Blocked", "Cannot move to 'Active'. GGSM SEG COND 'D' with Accounting Control Code 3, 5, or NULL is invalid.")
    RETURN
END IF
```

```powerscript
// 6. Creating a BOM
FOR ll_row = 1 TO dw_bom.RowCount()
    string ls_seg_cond = dw_bom.GetItemString(ll_row, "ggsm_seg_cond")
    integer li_acc_ctrl_code = dw_bom.GetItemNumber(ll_row, "accounting_control_code")

    IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
        MessageBox("BOM Creation Error", "Invalid BOM SKU found. SEG COND 'D' with invalid Accounting Control Code.")
        RETURN
    END IF
NEXT
```

```powerscript
// 7. Adding a BOM output
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_bom_output.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_bom_output.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Error", "Invalid BOM output SKU. GGSM SEG COND 'D' is not permitted with ACC Control Code 3, 5, or NULL.")
    RETURN
END IF
```

```powerscript
// 8. Adding a BOM component
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_bom_comp.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_bom_comp.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Error", "Invalid BOM component. GGSM SEG COND 'D' with Accounting Control Code 3, 5, or NULL not allowed.")
    RETURN
END IF
```

```powerscript
// 9. Inserting a demand order that creates a manufacturing order
string ls_seg_cond
integer li_acc_ctrl_code

ls_seg_cond = dw_demand.GetItemString(row, "ggsm_seg_cond")
li_acc_ctrl_code = dw_demand.GetItemNumber(row, "accounting_control_code")

IF ls_seg_cond = 'D' AND (IsNull(li_acc_ctrl_code) OR li_acc_ctrl_code = 3 OR li_acc_ctrl_code = 5) THEN
    MessageBox("Demand Order Error", "Cannot create mfg order from demand. SKU has invalid configuration.")
    RETURN
END IF
```
